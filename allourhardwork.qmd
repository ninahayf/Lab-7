---
title: "allourhardwork"
format: html
---

## making the dates in format YYYY-MM-DD
library(lubridate)

hot_days$Start_Date <- ym(hot_days$Start_Date)

cold_days$Start_date <- ym(cold_days$Start_Date)


## reading in data tables 
library(readr) 

cold_days <- read_csv("data/cold_days.csv")
View(cold_days)

hot_days <- read_csv("data/hot_days.csv")
View(hot_days)

elevation <- read_csv("data/elevation.csv")
View(elevation)

high_temp <- read_csv("data/highest_temp.csv")
View(high_temp)

humid <- read_csv("data/humidity.csv")
View(humid)

low_temp <- read_csv("data/lowest_temp.csv")
View(low_temp)

nrmavg <- read_csv("data/nrmavg.csv")
View(nrmavg)

nrmmax <- read_csv("data/nrmmax.csv")
View(nrmmax)

nrmmin <- read_csv("data/nrmmin.csv")
View(nrmmin)

UHI <- read_csv("data/UHI.csv")
View(UHI)

CO_LA <- read_csv("data/denver_neworleans.csv")
View(CO_LA)


## Combining A (afternoon) and M (morning) data within humidity dataset 
humid <- read.csv("data/humidity.csv")

colnames(humid)

colnames(humid) <- c("Station ID", "City", "State", "Start Date", "End Date", "JAN_M", "JAN_A", "FEB_M", "FEB_A", "MAR_M", "MAR_A", "APR_M", "APR_A", "MAY_M", "MAY_A", "JUN_M", "JUN_A", "JUL_M", "JUL_A", "AUG_M", "AUG_A", "SEP_M", "SEP_A", "OCT_M", "OCT_A", "NOV_M", "NOV_A", "DEC_M", "DEC_A", "ANN_M", "ANN_A")

colnames(humid)

# Line plot comparing Den to NewO humidity 
```{r}
library(dplyr)
library(tidyr)
library(ggplot2)

# Filter data for Den and NewO
humid_filtered <- humid %>%
  filter(City %in% c("DENVER", "NEW ORLEANS")) %>%
  select(City, JAN_M, JAN_A, FEB_M, FEB_A, MAR_M, MAR_A, APR_M, APR_A, MAY_M, MAY_A, JUN_M, JUN_A, JUL_M, JUL_A, AUG_M, AUG_A, SEP_M, SEP_A, OCT_M, OCT_A, NOV_M, NOV_A, DEC_M, DEC_A, ANN_M, ANN_A)

# Reshape data
humid_long <- humid_filtered %>%
  pivot_longer(cols = JAN_M:DEC_A,  
               names_to = c("Month", "Time"), 
               names_pattern = "(\\w{3})_(\\w)",
               values_to = "Humidity")

head(humid_long)
```
```{r}
library(ggplot2)

ggplot(humid_long, aes(x = Month, y = Humidity, color = City, group = interaction(City, Month))) +
  geom_line() +
  geom_point() +
  theme_minimal() +
  labs(title = "Monthly Humidity Comparison: Denver vs. New Orleans", 
       x = "Month", 
       y = "Humidity (%)") +
  scale_x_discrete(limits = c("JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC")) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
New Orleans towering over Denver in humidity year-round. 



## Bar Graph comparing Denvers elevation to New Orleans elevation
```{r}
library(readr)
library(dplyr)
library(ggplot2)

elev_data <- read.csv("data/elevation.csv")

elev_data$High.Feet <- as.numeric(gsub(",", "", elev_data$High.Feet))
elev_data$Low.Feet <- as.numeric(gsub(",", "", elev_data$Low.Feet))

two_cities <- elev_data %>%
  filter(City %in% c("DENVER", "NEW ORLEANS"))

ggplot(two_cities, aes(x = City, y = High.Feet)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "City", y = "Elevation (High Feet)", title = "City Elevation Comparison") +
  theme_minimal()
```
With Denver's elevation being significantly higher than New Orleans will give us a foundations to compare the extreme changes that happen at different elevations. 


## Bar Plot comparing UHI temperature differences 
```{r}
library(readr)
library(dplyr)
library(ggplot2)

UHI <- read.csv("data/UHI.csv")

# Clean column names
names(UHI) <- gsub(" ", "_", names(UHI))

# Filter for Denver and New Orleans
city_uhi <- UHI %>%
  filter(City %in% c("Denver", "New Orleans"))

# Select only the relevant columns (City and UHI temperature effect)
city_uhi <- city_uhi %>%
  select(City, Citywide.urban.heat.island.effect..rolled.up.from.census.tract.data..weighted.by.area..in.degrees.F.)

# Rename the UHI column for clarity
colnames(city_uhi)[2] <- "UHI_Effect_F"

# Plot the UHI temperature differences
ggplot(city_uhi, aes(x = City, y = UHI_Effect_F, fill = City)) +
  geom_bar(stat = "identity", width = 0.6) +
  geom_text(aes(label = round(UHI_Effect_F, 1)), vjust = -0.5) +  # Add value labels above bars
  labs(
    title = "Urban Heat Island Effect: Denver vs New Orleans",
    x = "City",
    y = "UHI Temperature Difference (°F)"
  ) +
  scale_fill_manual(values = c("skyblue", "pink")) +
  theme_minimal() +
  theme(legend.position = "none")
```
This plot shows the UHI difference (in °F) for both cities. New Orleans's higher UHI is expected because of the low-elevation and humidity and the fact that it is pretty warm there year round. This creates a greater challenge for New Orleans when it comes to managing heat. Denver's UHI isn't nearly as bad because of the dry air and higher elevation. 

## Comparing # of hot & cold days between Denver and New Orleans in a Bar Plot
```{r}
library(dplyr)
library(ggplot2)
library(tidyr)

# Read the cold and hot datasets 
cold_days <- read.csv("data/cold_days.csv")
hot_days <- read.csv("data/hot_days.csv")

# Filter for Denver and New Orleans only 
cold_days_filtered <- cold_days %>%
  filter(City %in% c("DENVER", "NEW ORLEANS")) %>%
  mutate(type = "Cold Days (≤32°F)")

hot_days_filtered <- hot_days %>%
  filter(City %in% c("DENVER", "NEW ORLEANS")) %>%
  mutate(type = "Hot Days (≥90°F)")

# Add a new column to distinguish hot and cold
cold_days_filtered$type <- "Cold Days (≤32°F)"
hot_days_filtered$type <- "Hot Days (≥90°F)"

# Only keep City, State, Start_Date, and ANN (Annual total)
cold_days_clean <- cold_days_filtered %>%
  select(City, State, Start_Date, ANN, type)

hot_days_clean <- hot_days_filtered %>%
  select(City, State, Start_Date, ANN, type)

# Rename ANN to Days
cold_days_clean <- cold_days_clean %>%
  rename(Days = ANN)

hot_days_clean <- hot_days_clean %>%
  rename(Days = ANN)

# Start_Date being the same for both datasets
cold_days_clean <- cold_days_clean %>%
  mutate(Start_Date = as.character(Start_Date))

hot_days_clean <- hot_days_clean %>%
  mutate(Start_Date = as.character(Start_Date))

# Combine cold and hot datasets 
combined_days <- bind_rows(cold_days_clean, hot_days_clean)

# Convert Start_Date to Year
combined_days <- combined_days %>%
  mutate(Year = as.numeric(substr(Start_Date, 1, 4)))

# Plot
ggplot(combined_days, aes(x = City, y = Days, fill = type)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(
    title = "Hot and Cold Days in Denver vs New Orleans",
    x = "City",
    y = "Number of Days",
    fill = "Temperature Type"
  ) +
  theme_minimal() +
  scale_fill_manual(values = c("blue", "pink"))
```
New Orleans has more missing data values than Denver did, hence why the dramatic difference. Setting aside climate change, we know that New Orleans has significantly more hot days than Denver because its closer to the equator. 

## 
```{r}
library(dplyr)
library(ggplot2)

# Read the data
UHI <- read.csv("data/UHI.csv")
humidity <- read.csv("data/humidity.csv")
nrmavg <- read.csv("data/nrmavg.csv")

# Clean and prepare UHI data
UHI_clean <- UHI %>%
  filter(City %in% c("Denver", "New Orleans")) %>%
  select(City, Year, Citywide.urban.heat.island.effect..rolled.up.from.census.tract.data..weighted.by.population.exposure..in.degrees.F.)

# Clean humidity data (assume columns are City, Year, Humidity)
humidity_clean <- humidity %>%
  filter(City %in% c("DENVER", "NEW ORLEANS")) %>%
  select(City, Year, ANN)

# Clean nrmavg data (normal average temperatures)
nrmavg_clean <- nrmavg %>%
  filter(City %in% c("DENVER", "NEW ORLEANS")) %>%
  select(City, Year, nrmavg)

# Merge all datasets by City and Year
combined_data <- UHI_clean %>%
  left_join(humidity_clean, by = c("City", "Year")) %>%
  left_join(nrmavg_clean, by = c("City", "Year"))

# Now combined_data contains: City, Year, UHI, Humidity, and Normal Average Temperature

# Visualize: Plotting UHI, humidity, and normal temperature over time
ggplot(combined_data, aes(x = Year)) +
  geom_line(aes(y = nrmavg, color = "Normal Temperature"), size = 1) +
  geom_line(aes(y = Citywide.urban.heat.island.effect..rolled.up.from.census.tract.data..weighted.by.population.exposure..in.degrees.F., color = "UHI"), size = 1) +
  geom_line(aes(y = Annual.relative.humidity, color = "Humidity"), size = 1) +
  facet_wrap(~City) +
  labs(
    title = "Temperature, UHI, and Humidity Trends: Denver vs New Orleans",
    x = "Year",
    y = "Value",
    color = "Variable"
  ) +
  theme_minimal() +
  scale_color_manual(values = c("blue", "red", "green"))
```







